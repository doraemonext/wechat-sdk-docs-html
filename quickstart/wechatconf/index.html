<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://wechat-python-sdk.com/quickstart/wechatconf/">
        <link rel="shortcut icon" href="../../img/favicon.ico">

	<title>3. WechatConf è¯¦è§£ - wechat-python-sdk</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">
        <link href="../../extra.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">wechat-python-sdk</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">é¦–é¡µ</a>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">å¿«é€Ÿä¸Šæ‰‹ <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../intro/">1. SDK å¿«é€Ÿä»‹ç»</a>
</li>

                    
                        
<li >
    <a href="../official/">2. å®˜æ–¹æ¥å£</a>
</li>

                    
                        
<li class="active">
    <a href="./">3. WechatConf è¯¦è§£</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">å®˜æ–¹æ¥å£ <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../official/intro/">0. å‰ç½®ä»‹ç»</a>
</li>

                    
                        
<li >
    <a href="../../official/access/">1. æ¥å…¥æŒ‡å—</a>
</li>

                    
                        
<li >
    <a href="../../official/message/">2. æ¶ˆæ¯ç®¡ç†</a>
</li>

                    
                        
<li >
    <a href="../../official/menu/">3. è‡ªå®šä¹‰èœå•</a>
</li>

                    
                        
<li >
    <a href="../../official/website/">4. å¾®ä¿¡ç½‘é¡µå¼€å‘</a>
</li>

                    
                        
<li >
    <a href="../../official/material/">5. ç´ æç®¡ç†</a>
</li>

                    
                        
<li >
    <a href="../../official/user/">6. ç”¨æˆ·ç®¡ç†</a>
</li>

                    
                        
<li >
    <a href="../../official/account/">7. è´¦å·ç®¡ç†</a>
</li>

                    
                        
<li >
    <a href="../../official/datacube/">8. æ•°æ®ç»Ÿè®¡</a>
</li>

                    
                        
<li >
    <a href="../../official/store/">9. å¾®ä¿¡å°åº— </a>
</li>

                    
                        
<li >
    <a href="../../official/service/">10. å¾®ä¿¡å¤šå®¢æœåŠŸèƒ½</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">API æ–‡æ¡£ <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../api/wechatconf/">1. WechatConf</a>
</li>

                    
                        
<li >
    <a href="../../api/wechatmessage/">2. WechatMessage</a>
</li>

                    
                        
<li >
    <a href="../../api/exception/">3. å¼‚å¸¸ç±»</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li >
                    <a href="../../faq/">FAQ</a>
                </li>
            
            
            
                <li >
                    <a href="../../about/project/">å…³äºé¡¹ç›®</a>
                </li>
            
            
            
                <li >
                    <a href="../../about/author/">å…³äºä½œè€…</a>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                <li >
                    <a rel="next" href="../official/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../../official/intro/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/wechat-python-sdk">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#-wechatconf">å¿«é€Ÿä¸Šæ‰‹ - WechatConf è¯¦è§£</a></li>
        
            <li><a href="#_1">åŸºæœ¬ä¿¡æ¯ä¼ å…¥</a></li>
        
            <li><a href="#access_token">access_token ç»´æŠ¤</a></li>
        
            <li><a href="#jsapi_ticket">jsapi_ticket ç»´æŠ¤</a></li>
        
            <li><a href="#_6">ä¸‹ä¸€æ­¥</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="-wechatconf">å¿«é€Ÿä¸Šæ‰‹ - WechatConf è¯¦è§£<a class="headerlink" href="#-wechatconf" title="Permanent link">&para;</a></h1>
<p>WechatConf æ˜¯ <strong>å¾®ä¿¡é…ç½®ç±»</strong>ï¼Œä½ éœ€è¦å°†åœ¨å…¬ä¼—å¹³å°å¼€å‘è€…é€‰é¡¹ä¸­çš„ Token/AppID/AppSecret/EncodingAESKey ç­‰ä¿¡æ¯ä¼ å…¥å…¶ä¸­ï¼Œä¹‹åè¯¥ç±»å°†ä¼šè‡ªè¡Œç»´æŠ¤ç›¸å…³é…ç½®ä¿¡æ¯ï¼ˆaccess_token/jsapi_ticketï¼‰çš„æœ‰æ•ˆæ€§ï¼Œæ”¯æŒåˆ†å¸ƒå¼ã€‚</p>
<blockquote>
<p>Tips: v0.6.0 ä»¥å‰ç‰ˆæœ¬çš„ç”¨æˆ·è¯·å°½å¿«è¿ç§»åˆ° WechatConf æ–¹å¼ï¼ŒåŸåˆå§‹åŒ–æ–¹å¼å°†ä¸ä¼šç»§ç»­ç»´æŠ¤ï¼ˆä½†ä¼šä¸€ç›´ä¿æŒå…¼å®¹ï¼‰ï¼Œä¹Ÿä¸ä¼šæä¾› EncodingAESKey åŠ å¯†ã€‚</p>
</blockquote>
<h2 id="_1">åŸºæœ¬ä¿¡æ¯ä¼ å…¥<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>WechatConf æ¥å—çš„åŸºæœ¬ä¿¡æ¯åŒ…æ‹¬ï¼š</p>
<ul>
<li>Token</li>
<li>App ID</li>
<li>App Secret</li>
<li>Encrypt Mode ï¼ˆæ¶ˆæ¯åŠ è§£å¯†æ¨¡å¼ï¼Œå¯é€‰é¡¹æœ‰ <code>normal</code>ï¼ˆæ˜æ–‡æ¨¡å¼ï¼‰ã€<code>compatible</code>ï¼ˆå…¼å®¹æ¨¡å¼ï¼‰ã€<code>safe</code>ï¼ˆå®‰å…¨æ¨¡å¼ï¼‰</li>
<li>EncodingAESKey ï¼ˆå½“ Encrypt Mode ä¸º <code>normal</code> æ—¶æ— éœ€ä¼ å…¥æ­¤é¡¹ï¼‰</li>
</ul>
<p>ä½¿ç”¨æ–¹å¼ä¹Ÿå¾ˆç®€å•ï¼Œç¤ºä¾‹ï¼š</p>
<pre><code class="python">from wechat_sdk import WechatConf
conf = WechatConf(
    token='your_token', 
    appid='your_appid', 
    appsecret='your_appsecret', 
    encrypt_mode='safe',  # å¯é€‰é¡¹ï¼šnormal/compatible/safeï¼Œåˆ†åˆ«å¯¹åº”äº æ˜æ–‡/å…¼å®¹/å®‰å…¨ æ¨¡å¼
    encoding_aes_key='your_encoding_aes_key'  # å¦‚æœä¼ å…¥æ­¤å€¼åˆ™å¿…é¡»ä¿è¯åŒæ—¶ä¼ å…¥ token, appid
)
</code></pre>

<p>æ ¹æ®ä½ è‡ªå·±éœ€è¦ä¼ å…¥å¯¹åº”å‚æ•°å³å¯ï¼Œæ‰€æœ‰é¡¹å‡ä¸ºå¯é€‰é¡¹ã€‚</p>
<h2 id="access_token">access_token ç»´æŠ¤<a class="headerlink" href="#access_token" title="Permanent link">&para;</a></h2>
<p>å¦‚æœä½ åœ¨ä½¿ç”¨ WechatConf çš„æ—¶å€™åªä¼ å…¥åŸºæœ¬ä¿¡æ¯ï¼Œåˆ™ä¼šåœ¨æ¯æ¬¡å®ä¾‹åŒ–æ—¶è¯·æ±‚ä¸€æ¬¡ access_tokenã€‚æ¯å¤©çš„ access_token æœ‰ç€å›ºå®šçš„æ¬¡æ•°é™åˆ¶ï¼Œè€Œä¸”æ¯æ¬¡è¯·æ±‚æ–°çš„ access_token ä¼šæ‹–æ…¢ä»£ç æ‰§è¡Œæ•ˆç‡ï¼Œæ‰€ä»¥ï¼Œ<strong>ä½ éœ€è¦æ ¹æ®ä½ çš„ä»£ç è¿è¡Œç¯å¢ƒåŠä½ çš„ä¸ªäººå–œå¥½é€‰æ‹©ä¸‹é¢ä»»æ„ä¸€ç§æ–¹å¼ç¼“å­˜ access_token çš„å€¼ã€‚</strong></p>
<h3 id="1-">æ–¹å¼ 1 - å•æœºç¯å¢ƒ<a class="headerlink" href="#1-" title="Permanent link">&para;</a></h3>
<p>å•æœºç¯å¢ƒä¸‹ï¼Œå¯ä»¥å°† access_token åŠè¿‡æœŸæ—¶é—´å­˜æ”¾åœ¨ä»»æ„ä½ç½®ï¼ˆç£ç›˜æ–‡ä»¶/æ•°æ®åº“/ç¼“å­˜ç­‰ï¼‰ã€‚ä½ éœ€è¦åšçš„åªæ˜¯åœ¨æ¯æ¬¡ WechatConf å®ä¾‹åŒ–çš„æ—¶å€™å°†ä½ å­˜å‚¨çš„ access_token å’Œ access_token_expires_at ä½œä¸ºå‚æ•°ä¼ å…¥å³å¯ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<pre><code class="python">access_token = get_access_token_from_somewhere()
access_token_expires_at = get_access_token_expires_at_from_somewhere()

conf = WechatConf(
    ... ,  # åŸºæœ¬ä¿¡æ¯ä¼ å…¥ï¼Œæ­¤å¤„å¿½ç•¥
    access_token=access_token,
    access_token_expires_at=access_token_expires_at,
)
</code></pre>

<p>å½“ç¬¬ä¸€æ¬¡å®ä¾‹åŒ–æ²¡æœ‰æœ‰æ•ˆçš„ access_token æ—¶ï¼Œè¿™ä¸¤ä¸ªå‚æ•°å…¨éƒ¨ä¼ å…¥ <code>None</code> å³å¯ã€‚</p>
<p>å®ä¾‹åŒ–å®Œæˆåï¼ˆé¦–æ¬¡å®ä¾‹åŒ–ä¸¤ä¸ªå‚æ•°å‡ä½¿ç”¨ <code>None</code>ï¼‰ï¼Œä½ éœ€è¦åœ¨è¯¥å®ä¾‹æœ‰æ•ˆæœŸå†…çš„ä»»æ„æ—¶åˆ»è°ƒç”¨ <a href="../../api/wechatconf/#get_access_token"><code>.get_access_token()</code></a> æ–¹æ³•è·å¾—è‡ªåŠ¨ç»´æŠ¤è¿‡çš„æ–°çš„ access_token å’Œ access_token_expires_at å€¼ï¼Œç„¶åå°†ä»–ä»¬ç”¨ä½ è‡ªå·±çš„æ–¹å¼ï¼ˆç£ç›˜æ–‡ä»¶/æ•°æ®åº“/ç¼“å­˜ï¼‰è¿›è¡Œä¿å­˜ï¼Œæ–¹ä¾¿ä¸‹æ¬¡å®ä¾‹åŒ–çš„æ—¶å€™ä¼ å…¥ã€‚</p>
<p><a href="../../api/wechatconf/#get_access_token"><code>.get_access_token()</code></a> çš„è¿”å›ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<pre><code class="python">{
    &quot;access_token&quot;:&quot;Uj6gDn1My01ElQvLXjudqdXlnTYosqWnxPT-1AX_jJEqeYhbqASZXPlnur7k6YV7Erjvd_JDXbQWeZYIMmu958WV4VWe7GKD65q_VLHecTp8nA5DwU_DOdmVBACU2wDkPGBbAHAEVQ&quot;,
    &quot;access_token_expires_at&quot;:1454476716
}
</code></pre>

<h3 id="2-">æ–¹å¼ 2 - å•æœºç¯å¢ƒ<a class="headerlink" href="#2-" title="Permanent link">&para;</a></h3>
<p>ç¬¬äºŒç§æ–¹å¼å°† access_token åŠ access_token_expires_at çš„è·å–ä¸è®¾ç½®çš„æƒåˆ©å®Œå…¨äº¤ä»˜ä¸ä½ ã€‚ä½ åªéœ€è¦å†™ä¸¤ä¸ªå‡½æ•°ï¼Œåˆ†åˆ«å»è·å– access_token å’Œè®¾ç½® access_token å³å¯ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<pre><code class="python">def get_access_token_function():
    &quot;&quot;&quot; æ³¨æ„è¿”å›å€¼ä¸ºä¸€ä¸ª Tupleï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ä¸º access_token çš„å€¼ï¼Œç¬¬äºŒä¸ªå…ƒç´ ä¸º access_token_expires_at çš„å€¼ &quot;&quot;&quot;
    return get_access_token_from_somewhere()  # æ­¤å¤„é€šè¿‡ä½ è‡ªå·±çš„æ–¹å¼è·å– access_token

def set_access_token_function(access_token, access_token_expires_at):
    set_access_token_to_somewhere(access_token, access_token_expires_at)  # æ­¤å¤„é€šè¿‡ä½ è‡ªå·±çš„æ–¹å¼è®¾ç½® access_token
</code></pre>

<p>æ¥ç€ä½ éœ€è¦åšçš„å°±æ˜¯åœ¨ WechatConf å®ä¾‹åŒ–çš„æ—¶å€™å°†è¿™ä¸¤ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="python">from wechat_sdk import WechatConf
conf = WechatConf(
    ... ,  # åŸºæœ¬ä¿¡æ¯ä¼ å…¥ï¼Œæ­¤å¤„å¿½ç•¥
    access_token_getfunc=get_access_token_function,
    access_token_setfunc=set_access_token_function,
)
</code></pre>

<p>ç»è¿‡ä»¥ä¸Šæ­¥éª¤ï¼ŒWechatConf å®ä¾‹å†…éƒ¨åœ¨ç»´æŠ¤ access_token æœ‰æ•ˆæ€§æ—¶å‡ä¼šè°ƒç”¨ä½ è‡ªå·±çš„å‡½æ•°å»æ“ä½œã€‚</p>
<h3 id="3-">æ–¹å¼ 3 - åˆ†å¸ƒå¼ç¯å¢ƒ<a class="headerlink" href="#3-" title="Permanent link">&para;</a></h3>
<p>å¦‚æœä½ éœ€è¦åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ä½¿ç”¨ wechat-python-sdkï¼Œé‚£ä¹ˆæœåŠ¡å™¨çš„ç±»å‹åˆ†ä¸¤ç§ï¼Œä¸€ç§æ˜¯ä¸­æ§æœåŠ¡å™¨ï¼Œå¦ä¸€ç§æ˜¯ä¸šåŠ¡é€»è¾‘æœåŠ¡å™¨ï¼š</p>
<ul>
<li>ä¸­æ§æœåŠ¡å™¨ç”¨äº access_token çš„è·å–å’Œåˆ·æ–°ï¼Œä¸ºä¸šåŠ¡é€»è¾‘æœåŠ¡å™¨æä¾›è·å–æ¥å£ä»¥åŠå¼ºåˆ¶åˆ·æ–°æ¥å£ã€‚ä»…éœ€ä¸€å°ä¸­æ§æœåŠ¡å™¨ã€‚</li>
<li>ä¸šåŠ¡é€»è¾‘æœåŠ¡å™¨çš„ access_token å‡æ˜¯è°ƒç”¨ä¸­æ§æœåŠ¡å™¨çš„æ¥å£å¾—æ¥ï¼Œç¦æ­¢ä¸šåŠ¡é€»è¾‘æœåŠ¡å™¨è‡ªè¡Œåˆ·æ–° access_tokenã€‚</li>
</ul>
<h4 id="_2">ä¸­æ§æœåŠ¡å™¨<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h4>
<p>ä¸­æ§æœåŠ¡å™¨çš„è®¾ç½®å‚è€ƒ <a href="#2-">æ–¹å¼ 2 - å•æœºç¯å¢ƒ</a> è®¾ç½®å³å¯ï¼Œæ¨èå°† access_token åŠ access_token_expires_at æ”¾ç½®äºç¼“å­˜æœåŠ¡å™¨ä¸­ã€‚å¯¹å¤–æä¾›çš„æ¥å£éœ€è‡ªè¡Œç¼–å†™ã€‚</p>
<h4 id="_3">ä¸šåŠ¡é€»è¾‘æœåŠ¡å™¨<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<p>ä¸šåŠ¡é€»è¾‘æœåŠ¡å™¨çš„ä»£ç ç¨æœ‰äº›ä¸åŒï¼Œå› ä¸ºä¸èƒ½ç›´æ¥é€šè¿‡è…¾è®¯å®˜æ–¹ URL æ¥åˆ·æ–° access_tokenï¼Œæ‰€ä»¥éœ€è¦å°†åˆ·æ–°çš„æ“ä½œè½¬æ¥åˆ°ä¸­æ§æœåŠ¡å™¨ä¸Šã€‚WechatConf æä¾›äº† <code>access_token_refreshfunc</code> å‚æ•°ï¼Œä½ ä»ç„¶åªéœ€è¦å†™ä¸¤ä¸ªå‡½æ•°ï¼Œåˆ†åˆ«å–è·å– access_token å’Œåˆ·æ–° access_tokenã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<pre><code class="python">def get_access_token_function():
    &quot;&quot;&quot; æ³¨æ„è¿”å›å€¼ä¸ºä¸€ä¸ª Tupleï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ä¸º access_token çš„å€¼ï¼Œç¬¬äºŒä¸ªå…ƒç´ ä¸º access_token_expires_at çš„å€¼ &quot;&quot;&quot;
    return get_access_token_from_master()  # æ­¤å¤„é€šè¿‡ä½ è‡ªå·±çš„æ–¹å¼è·å– access_token

def refresh_access_token_function():
    &quot;&quot;&quot; æ³¨æ„è¿”å›å€¼ä¸ºä¸€ä¸ª Tupleï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ä¸º access_token çš„å€¼ï¼Œç¬¬äºŒä¸ªå…ƒç´ ä¸º access_token_expires_at çš„å€¼ &quot;&quot;&quot;
    return refresh_access_token_from_master()  # æ­¤å¤„è°ƒç”¨ä½ è‡ªå·±çš„ä¸­æ§æœåŠ¡å™¨åˆ·æ–° access_token æ¥å£
</code></pre>

<p>æ¥ä¸‹æ¥éœ€è¦åœ¨ WechatConf å®ä¾‹åŒ–çš„æ—¶å€™å°†è¿™ä¸¤ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="python">from wechat_sdk import WechatConf
conf = WechatConf(
    ... ,  # åŸºæœ¬ä¿¡æ¯ä¼ å…¥ï¼Œæ­¤å¤„å¿½ç•¥
    access_token_getfunc=get_access_token_function,
    access_token_refreshfunc=refresh_access_token_function,
)
</code></pre>

<p>ç»è¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œä¸šåŠ¡é€»è¾‘æœåŠ¡å™¨çš„ WechatConf å®ä¾‹å†…éƒ¨åœ¨ç»´æŠ¤ access_token æœ‰æ•ˆæ€§æ—¶å‡ä¼šè°ƒç”¨ä½ è‡ªå·±çš„å‡½æ•°å»è·å–å’Œåˆ·æ–°ã€‚</p>
<h2 id="jsapi_ticket">jsapi_ticket ç»´æŠ¤<a class="headerlink" href="#jsapi_ticket" title="Permanent link">&para;</a></h2>
<p><strong>å¦‚æœä½ çš„ä»£ç ä¸­å¹¶æœªæ¶‰åŠ JSSDK çš„ç›¸å…³å†…å®¹ï¼Œé‚£ä¹ˆä½ å¯ä»¥ç›´æ¥è·³è¿‡æœ¬èŠ‚ã€‚</strong></p>
<p>å¦‚æœä½ åœ¨ä½¿ç”¨ WechatConf çš„æ—¶å€™åªä¼ å…¥åŸºæœ¬ä¿¡æ¯ï¼Œåˆ™ä¼šåœ¨æ¯æ¬¡å®ä¾‹åŒ–æ—¶è¯·æ±‚ä¸€æ¬¡ jsapi_ticketã€‚æ¯å¤©çš„ jsapi_ticket æœ‰ç€å›ºå®šçš„æ¬¡æ•°é™åˆ¶ï¼Œè€Œä¸”æ¯æ¬¡è¯·æ±‚æ–°çš„ jsapi_ticket ä¼šæ‹–æ…¢ä»£ç æ‰§è¡Œæ•ˆç‡ï¼Œæ‰€ä»¥ï¼Œ<strong>ä½ éœ€è¦æ ¹æ®ä½ çš„ä»£ç è¿è¡Œç¯å¢ƒåŠä½ çš„ä¸ªäººå–œå¥½é€‰æ‹©ä¸‹é¢ä»»æ„ä¸€ç§æ–¹å¼ç¼“å­˜ jsapi_ticket çš„å€¼ã€‚</strong></p>
<h3 id="1-_1">æ–¹å¼ 1 - å•æœºç¯å¢ƒ<a class="headerlink" href="#1-_1" title="Permanent link">&para;</a></h3>
<p>å•æœºç¯å¢ƒä¸‹ï¼Œå¯ä»¥å°† jsapi_ticket åŠè¿‡æœŸæ—¶é—´å­˜æ”¾åœ¨ä»»æ„ä½ç½®ï¼ˆç£ç›˜æ–‡ä»¶/æ•°æ®åº“/ç¼“å­˜ç­‰ï¼‰ã€‚ä½ éœ€è¦åšçš„åªæ˜¯åœ¨æ¯æ¬¡ WechatConf å®ä¾‹åŒ–çš„æ—¶å€™å°†ä½ å­˜å‚¨çš„ jsapi_ticket å’Œ jsapi_ticket_expires_at ä½œä¸ºå‚æ•°ä¼ å…¥å³å¯ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<pre><code class="python">jsapi_ticket = get_jsapi_ticket_from_somewhere()
jsapi_ticket_expires_at = get_jsapi_ticket_expires_at_from_somewhere()

conf = WechatConf(
    ... ,  # åŸºæœ¬ä¿¡æ¯ä¼ å…¥ï¼Œæ­¤å¤„å¿½ç•¥
    jsapi_ticket=jsapi_ticket,
    jsapi_ticket_expires_at=jsapi_ticket_expires_at,
)
</code></pre>

<p>å½“ç¬¬ä¸€æ¬¡å®ä¾‹åŒ–æ²¡æœ‰æœ‰æ•ˆçš„ jsapi_ticket æ—¶ï¼Œè¿™ä¸¤ä¸ªå‚æ•°å…¨éƒ¨ä¼ å…¥ <code>None</code> å³å¯ã€‚</p>
<p>å®ä¾‹åŒ–å®Œæˆåï¼ˆé¦–æ¬¡å®ä¾‹åŒ–ä¸¤ä¸ªå‚æ•°å‡ä½¿ç”¨ <code>None</code>ï¼‰ï¼Œä½ éœ€è¦åœ¨è¯¥å®ä¾‹æœ‰æ•ˆæœŸå†…çš„ä»»æ„æ—¶åˆ»è°ƒç”¨ <a href="../../api/wechatconf/#get_jsapi_ticket"><code>.get_jsapi_ticket()</code></a> æ–¹æ³•è·å¾—è‡ªåŠ¨ç»´æŠ¤è¿‡çš„æ–°çš„ jsapi_ticket å’Œ jsapi_ticket_expires_at å€¼ï¼Œç„¶åå°†ä»–ä»¬ç”¨ä½ è‡ªå·±çš„æ–¹å¼ï¼ˆç£ç›˜æ–‡ä»¶/æ•°æ®åº“/ç¼“å­˜ï¼‰è¿›è¡Œä¿å­˜ï¼Œæ–¹ä¾¿ä¸‹æ¬¡å®ä¾‹åŒ–çš„æ—¶å€™ä¼ å…¥ã€‚</p>
<p><a href="../../api/wechatconf/#get_jsapi_ticket"><code>.get_jsapi_ticket()</code></a> çš„è¿”å›ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<pre><code class="python">{
    &quot;jsapi_ticket&quot;:&quot;bxLdikRXVbTPdHSM05e5u8EoHz_JA7Re-noqE0ZAnxk3XzAntyhT4_k272aJ4LprCM68rVXv6DDydT7JW1Mwsw&quot;,
    &quot;jsapi_ticket_expires_at&quot;: 1454476720
}
</code></pre>

<h3 id="2-_1">æ–¹å¼ 2 - å•æœºç¯å¢ƒ<a class="headerlink" href="#2-_1" title="Permanent link">&para;</a></h3>
<p>ç¬¬äºŒç§æ–¹å¼å°† jsapi_ticket åŠ jsapi_ticket_expires_at çš„è·å–ä¸è®¾ç½®çš„æƒåˆ©å®Œå…¨äº¤ä»˜ä¸ä½ ã€‚ä½ åªéœ€è¦å†™ä¸¤ä¸ªå‡½æ•°ï¼Œåˆ†åˆ«å»è·å– jsapi_ticket å’Œè®¾ç½® jsapi_ticket å³å¯ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<pre><code class="python">def get_jsapi_ticket_function():
    &quot;&quot;&quot; æ³¨æ„è¿”å›å€¼ä¸ºä¸€ä¸ª Tupleï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ä¸º jsapi_ticket çš„å€¼ï¼Œç¬¬äºŒä¸ªå…ƒç´ ä¸º jsapi_ticket_expires_at çš„å€¼ &quot;&quot;&quot;
    return get_jsapi_ticket_from_somewhere()  # æ­¤å¤„é€šè¿‡ä½ è‡ªå·±çš„æ–¹å¼è·å– jsapi_ticket

def set_jsapi_ticket_function(jsapi_ticket, jsapi_ticket_expires_at):
    set_jsapi_ticket_to_somewhere(jsapi_ticket, jsapi_ticket_expires_at)  # æ­¤å¤„é€šè¿‡ä½ è‡ªå·±çš„æ–¹å¼è®¾ç½® jsapi_ticket
</code></pre>

<p>æ¥ç€ä½ éœ€è¦åšçš„å°±æ˜¯åœ¨ WechatConf å®ä¾‹åŒ–çš„æ—¶å€™å°†è¿™ä¸¤ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="python">from wechat_sdk import WechatConf
conf = WechatConf(
    ... ,  # åŸºæœ¬ä¿¡æ¯ä¼ å…¥ï¼Œæ­¤å¤„å¿½ç•¥
    jsapi_ticket_getfunc=get_jsapi_ticket_function,
    jsapi_ticket_setfunc=set_jsapi_ticket_function,
)
</code></pre>

<p>ç»è¿‡ä»¥ä¸Šæ­¥éª¤ï¼ŒWechatConf å®ä¾‹å†…éƒ¨åœ¨ç»´æŠ¤ jsapi_ticket æœ‰æ•ˆæ€§æ—¶å‡ä¼šè°ƒç”¨ä½ è‡ªå·±çš„å‡½æ•°å»æ“ä½œã€‚</p>
<h3 id="3-_1">æ–¹å¼ 3 - åˆ†å¸ƒå¼ç¯å¢ƒ<a class="headerlink" href="#3-_1" title="Permanent link">&para;</a></h3>
<p>å¦‚æœä½ éœ€è¦åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ä½¿ç”¨ wechat-python-sdkï¼Œé‚£ä¹ˆæœåŠ¡å™¨çš„ç±»å‹åˆ†ä¸¤ç§ï¼Œä¸€ç§æ˜¯ä¸­æ§æœåŠ¡å™¨ï¼Œå¦ä¸€ç§æ˜¯ä¸šåŠ¡é€»è¾‘æœåŠ¡å™¨ï¼š</p>
<ul>
<li>ä¸­æ§æœåŠ¡å™¨ç”¨äº jsapi_ticket çš„è·å–å’Œåˆ·æ–°ï¼Œä¸ºä¸šåŠ¡é€»è¾‘æœåŠ¡å™¨æä¾›è·å–æ¥å£ä»¥åŠå¼ºåˆ¶åˆ·æ–°æ¥å£ã€‚ä»…éœ€ä¸€å°ä¸­æ§æœåŠ¡å™¨ã€‚</li>
<li>ä¸šåŠ¡é€»è¾‘æœåŠ¡å™¨çš„ jsapi_ticket å‡æ˜¯è°ƒç”¨ä¸­æ§æœåŠ¡å™¨çš„æ¥å£å¾—æ¥ï¼Œç¦æ­¢ä¸šåŠ¡é€»è¾‘æœåŠ¡å™¨è‡ªè¡Œåˆ·æ–° jsapi_ticketã€‚</li>
</ul>
<h4 id="_4">ä¸­æ§æœåŠ¡å™¨<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<p>ä¸­æ§æœåŠ¡å™¨çš„è®¾ç½®å‚è€ƒ <a href="#2-_1">æ–¹å¼ 2 - å•æœºç¯å¢ƒ</a> è®¾ç½®å³å¯ï¼Œæ¨èå°† jsapi_ticket åŠ jsapi_ticket_expires_at æ”¾ç½®äºç¼“å­˜æœåŠ¡å™¨ä¸­ã€‚å¯¹å¤–æä¾›çš„æ¥å£éœ€è‡ªè¡Œç¼–å†™ã€‚</p>
<h4 id="_5">ä¸šåŠ¡é€»è¾‘æœåŠ¡å™¨<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<p>ä¸šåŠ¡é€»è¾‘æœåŠ¡å™¨çš„ä»£ç ç¨æœ‰äº›ä¸åŒï¼Œå› ä¸ºä¸èƒ½ç›´æ¥é€šè¿‡è…¾è®¯å®˜æ–¹ URL æ¥åˆ·æ–° jsapi_ticketï¼Œæ‰€ä»¥éœ€è¦å°†åˆ·æ–°çš„æ“ä½œè½¬æ¥åˆ°ä¸­æ§æœåŠ¡å™¨ä¸Šã€‚WechatConf æä¾›äº† <code>jsapi_ticket_refreshfunc</code> å‚æ•°ï¼Œä½ ä»ç„¶åªéœ€è¦å†™ä¸¤ä¸ªå‡½æ•°ï¼Œåˆ†åˆ«å–è·å– jsapi_ticket å’Œåˆ·æ–° jsapi_ticketã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<pre><code class="python">def get_jsapi_ticket_function():
    &quot;&quot;&quot; æ³¨æ„è¿”å›å€¼ä¸ºä¸€ä¸ª Tupleï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ä¸º jsapi_ticket çš„å€¼ï¼Œç¬¬äºŒä¸ªå…ƒç´ ä¸º jsapi_ticket_expires_at çš„å€¼ &quot;&quot;&quot;
    return get_jsapi_ticket_from_master()  # æ­¤å¤„é€šè¿‡ä½ è‡ªå·±çš„æ–¹å¼è·å– jsapi_ticket

def refresh_jsapi_ticket_function():
    &quot;&quot;&quot; æ³¨æ„è¿”å›å€¼ä¸ºä¸€ä¸ª Tupleï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ä¸º jsapi_ticket çš„å€¼ï¼Œç¬¬äºŒä¸ªå…ƒç´ ä¸º jsapi_ticket_expires_at çš„å€¼ &quot;&quot;&quot;
    return refresh_jsapi_ticket_from_master()  # æ­¤å¤„è°ƒç”¨ä½ è‡ªå·±çš„ä¸­æ§æœåŠ¡å™¨åˆ·æ–° jsapi_ticket æ¥å£
</code></pre>

<p>æ¥ä¸‹æ¥éœ€è¦åœ¨ WechatConf å®ä¾‹åŒ–çš„æ—¶å€™å°†è¿™ä¸¤ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="python">from wechat_sdk import WechatConf
conf = WechatConf(
    ... ,  # åŸºæœ¬ä¿¡æ¯ä¼ å…¥ï¼Œæ­¤å¤„å¿½ç•¥
    jsapi_ticket_getfunc=get_jsapi_ticket_function,
    jsapi_ticket_refreshfunc=refresh_jsapi_ticket_function,
)
</code></pre>

<p>ç»è¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œä¸šåŠ¡é€»è¾‘æœåŠ¡å™¨çš„ WechatConf å®ä¾‹å†…éƒ¨åœ¨ç»´æŠ¤ jsapi_ticket æœ‰æ•ˆæ€§æ—¶å‡ä¼šè°ƒç”¨ä½ è‡ªå·±çš„å‡½æ•°å»è·å–å’Œåˆ·æ–°ã€‚</p>
<h2 id="_6">ä¸‹ä¸€æ­¥<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<p>ç°åœ¨ä½ å·²ç»äº†è§£äº†å¦‚ä½•å°†åŸºæœ¬ä¿¡æ¯ä¼ å…¥ WechatConf å¹¶è‡ªè¡Œç»´æŠ¤ access_token åŠ jsapi_ticket çš„æœ‰æ•ˆæ€§ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œä½ å¯ä»¥ï¼š</p>
<ul>
<li>ç»§ç»­é˜…è¯» <a href="../../api/wechatconf/">WechatConf API</a> åŠ æ·±å¯¹ WechatConf çš„å°è±¡</li>
<li>ç›´æ¥ç‚¹å‡»å¯¼èˆªæ ä¸Šæ–¹çš„çš„ <strong>å®˜æ–¹æ¥å£</strong>ï¼Œé€‰æ‹©è‡ªå·±éœ€è¦çš„ç« èŠ‚è¿›è¡Œé˜…è¯»</li>
</ul></div>
        </div>

        <footer class="col-md-12">
            <hr>
            
                <center>Copyright 2014-2016 Ace Kwok</center>
            
            <center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>